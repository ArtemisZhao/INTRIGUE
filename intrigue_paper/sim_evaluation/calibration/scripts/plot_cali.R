pdf(file = "cali_cefn.pdf", width=8, height=8.2, bg="white", pointsize=16)
d1 = read.table("results/cali_rep.cefn.sort.dat")
fv =seq(0.0,0.8,0.1)
tv = seq(0.1, 0.9, 0.1)
pv = sapply(1:9,function(x) mean(d1$V3[d1$V2>=fv[x]&d1$V2<tv[x]]))
mv = sapply(1:9, function(x) mean(d1$V2[d1$V2>=fv[x]&d1$V2<tv[x]]))
sdv = sapply(1:9, function(x) sd(d1$V2[d1$V2>=fv[x]&d1$V2<tv[x]]))
plot(mv ~ pv, ylab="Reproducible probability", xlab = "True frequency",pch=16,cex=0.8,xlim=c(0,1),ylim= c(0,1), main="CEFN")
abline(0,1,lty=2,col="blue")
arrows(pv, mv-1.96*sdv, pv, mv+1.96*sdv, length=0.05, angle=90,code = 3)
dev.off()



pdf(file = "cali_meta.pdf", width=8, height=8.2, bg="white", pointsize=16)
d1 = read.table("results/cali_rep.meta.sort.dat")
fv =seq(0.0,0.8,0.1)
tv = seq(0.1, 0.9, 0.1)
pv = sapply(1:9,function(x) mean(d1$V3[d1$V2>=fv[x]&d1$V2<tv[x]]))
mv = sapply(1:9, function(x) mean(d1$V2[d1$V2>=fv[x]&d1$V2<tv[x]]))
sdv = sapply(1:9, function(x) sd(d1$V2[d1$V2>=fv[x]&d1$V2<tv[x]]))
plot(mv ~ pv, ylab="Reproducible probability", xlab = "True frequency",pch=16,cex=0.8,xlim=c(0,1),ylim= c(0,1), main="META")
abline(0,1,lty=2,col="blue")
arrows(pv, mv-1.96*sdv, pv, mv+1.96*sdv, length=0.05, angle=90,code = 3)
dev.off()

